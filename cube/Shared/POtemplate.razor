@inherits AppStateComponent

@if (T is null)
{

}
else
{
    <div class="card m-1">
        <div class="card-body">
            <h5 class="card-header">@T.reportName</h5>
            @if (T.poPrompt is null)
            {
                <em>No Procession Options</em>
            }
            else
            {
                <nav>
                    <ul class="nav nav-tabs" id="po-pages" role="presentation">
                        @foreach (var p in T.poPrompt.tabPages)
                        {
                            <li class="nav-item">
                                <button class="nav-link"
                            id="@($"page-{p.pageNumber}-tab")"
                            role="tab"
                            data-bs-toggle="tab"
                            data-bs-target="@($"#page-{p.pageNumber}")">
                                    @p.title
                                </button>
                            </li>
                        }
                    </ul>
                    <div class="tab-content" id="po-pages-content">
                        @foreach (var p in T.poPrompt.tabPages)
                        {
                            <div class="tab-pane fade" id="@($"page-{p.pageNumber}")" role="tabpanel">
                                <div class="row mt-2 mb-2 border-bottom">
                                    <div class="col-4">Version</div>
                                    @foreach (var v in L)
                                    {
                                        <div class="col border-start">@v.reportVersion</div>
                                    }
                                </div>
                                @foreach (var c in p.controls)
                                {
                                    <div class="row">
                                        <pre class="col-4">@c.title</pre>
                                        @foreach (var v in L)
                                        {
                                            <div class="col border-start"><pre>@(PoValue(v, c.idObject))</pre> </div>
                                        }
                                    </div>
                                }
                            </div>
                        }
                    </div>
                </nav>
            }
        </div>
    </div>
}

@code {
    AIS.DiscoveryUBEResponse T => State.VersionDiscoveryTemplate;
    IEnumerable<AIS.DiscoveryUBEResponse> L => State.VersionDiscoveryList;
    string PoValue(AIS.DiscoveryUBEResponse po, int id)
        => po.poValues.SingleOrDefault(p => p.id == id)?.value;
}
